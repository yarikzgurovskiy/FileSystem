@model FolderViewModel


<h2>@ViewData["Title"]</h2>

<div>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalCreateFolder">
        Create Folder
    </button>
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalLoadFile">
        Load File
    </button>
    
    <div class="col-lg-6">
        <div class="input-group">
            <form id="searchForm" asp-action="Search">
                <input type="text" class="form-control" placeholder="Search for...">
            </form>
            <span class="input-group-btn">
                <button type="submit" form="searchForm" class="btn btn-secondary" type="button">Go!</button>
            </span>
        </div>
    </div>
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            @foreach (var folder in Model.Path) {
                <li class="breadcrumb-item"><a asp-action="Drive" asp-route-id="@folder.Id">@folder.Name</a></li>
            }
            <li class="breadcrumb-item active" aria-current="page">@Model.Name</li>
        </ol>
    </nav>
    <hr />
    @if (Model.Folders.Count > 0 || Model.Files.Count > 0) {
        <div class="row">
            @foreach (var f in Model.Folders) {
                <div class="col-md-2">
                    <div class="card" style="width: 18rem">
                        <img class="card-img-top" src="~/images/folder.png" alt="Card image cap">
                        <div class="card-body">
                            <h3 class="card-body">@f.Name</h3>
                            <form method="post" id="@($"deleteFolder{f.Id}")" asp-action="DeleteFolder" asp-route-id="@f.Id" asp-route-folderId="@f.FolderId"></form>
                            <a asp-action="Drive" asp-route-id="@f.Id" class="btn btn-success"><span class="glyphicon glyphicon-chevron-right"></span>View</a>
                            <button type="submit" form="@($"deleteFolder{f.Id}")" class="btn btn-danger">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                            <a asp-action="EditFolder" asp-route-id="@f.Id" class="btn btn-info"><span class="glyphicon glyphicon-pencil"></span></a>
                        </div>
                    </div>
                </div>
            }
            @foreach (var f in Model.Files) {
                <div class="col-md-2">
                    <div class="card" style="width: 18rem">
                        <img class="card-img-top" src="~/images/file.png" alt="Card image cap">
                        <div class="card-body">
                            <h3 class="card-body">@f.Name</h3>
                            <form method="post" id="@($"deleteFile{f.Id}")" asp-action="DeleteFile" asp-route-id="@f.Id" asp-route-folderId="@f.FolderId"></form>
                            <a asp-action="DownloadFile" asp-route-id="@f.Id" class="btn btn-primary"><span class="glyphicon glyphicon-download"></span>Download</a>
                            <button type="submit" form="@($"deleteFile{f.Id}")" class="btn btn-danger">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                            <a asp-action="EditFile" asp-route-id="@f.Id" class="btn btn-info"><span class="glyphicon glyphicon-pencil"></span></a>
                        </div>
                    </div>
                </div>
            }
        </div>
    } else {
        <h1>Empty</h1>
    }
</div>

<!-- Create Folder Modal -->
<div class="modal fade" id="modalCreateFolder" tabindex="-1" role="dialog" aria-labelledby="modalCreateFolderLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title text-center">Create Folder</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="post" id="createFolder" asp-action="CreateFolder" asp-route-folderId="@Model.Id">
                    <div class="form-group">
                        <label for="folderName" class="control-label">Folder Name</label>
                        <input name="folderName" type="text" required maxlength="15" class="form-control" />
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-success" form="createFolder">Create</button>
            </div>
        </div>
    </div>
</div>

<!-- Load File Modal -->
<div class="modal fade" id="modalLoadFile" tabindex="-1" role="dialog" aria-labelledby="modalLoadFileLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title text-center">Load File</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form method="post" id="loadFile" class="col-md-4" asp-action="LoadFile" asp-route-folderId="@Model.Id" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="file" class="control-label">New file</label>
                        <input type="file" name="file" required/>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-success" form="loadFile">Load</button>
            </div>
        </div>
    </div>
</div>

